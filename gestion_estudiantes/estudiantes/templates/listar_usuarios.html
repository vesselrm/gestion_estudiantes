{% extends 'home.html' %}
{% load static %}

{% block title %}Lista de Usuarios{% endblock %}

{% block content %}
<h2>Lista de Usuarios</h2>

<div style="max-width:900px; margin:0 auto; background:white; padding:30px 40px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.15);">

    <div style="text-align:right; margin-bottom:20px;">
        {# ---- SOLO ADMIN puede registrar ---- #}
        {% if request.session.usuario_rol == "Administrador" %}
        <a href="{% url 'crear_usuario' %}" class="btn-action">‚ûï Registrar Usuario</a>
        {% endif %}
    </div>

    <table id="tablaUsuarios" class="display responsive nowrap" style="width:100%">
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Rol</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for u in usuarios %}
            <tr>
                <td>{{ u.nombre_usuario }}</td>
                <td>{{ u.rol }}</td>
                <td>
                    {# ---- SOLO ADMIN puede editar ---- #}
                    {% if request.session.usuario_rol == "Administrador" %}
                    <a href="{% url 'editar_usuario' u.id %}" class="btn-icon edit" title="Editar">
                        <i class="fas fa-edit"></i>
                    </a>
                    {% endif %}
                    {# ---- SOLO ADMIN puede eliminar ---- #}
                    {% if request.session.usuario_rol == "Administrador" %}
                    <a href="{% url 'eliminar_usuario' u.id %}" class="btn-icon delete" title="Eliminar">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="3">No hay usuarios registrados.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="text-align:center; margin-top:25px;">
        <a href="{% url 'home' %}" class="btn-home">üè† Volver al Inicio</a>
    </div>
</div>

<style>
/* ===== Botones principales ===== */
.btn-action, .btn-home {
    display: inline-block;
    text-decoration: none;
    padding: 10px 18px;
    border-radius: 8px;
    font-weight: bold;
    transition: all 0.3s ease;
    font-size: 14px;
    background: linear-gradient(90deg,#1c4a7c,#2e6aa3);
    color: white;
}
.btn-action:hover, .btn-home:hover {
    transform: scale(1.05);
}

/* ===== Botones icono ===== */
.btn-icon {
    display: inline-block;
    text-decoration: none;
    font-size: 16px;
    padding: 6px 10px;
    margin: 0 3px;
    border-radius: 6px;
    color: white;
    transition: all 0.3s ease;
}
.btn-icon i {
    pointer-events: none;
}

/* Editar */
.btn-icon.edit {
    background-color: #ffc107;
}
.btn-icon.edit:hover {
    background-color: #e0a800;
    transform: scale(1.2);
}

/* Eliminar */
.btn-icon.delete {
    background-color: #dc3545;
}
.btn-icon.delete:hover {
    background-color: #c82333;
    transform: scale(1.2);
}

/* ===== Tabla ===== */
table.dataTable th {
    background-color: #1c4a7c !important;
    color: white !important;
    text-align: center;
}
table.dataTable td {
    text-align: center;
}

/* ===== Estilo general ===== */
body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}
</style>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- DataTables -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

<script>
$(document).ready(function () {
    $('#tablaUsuarios').DataTable({
        responsive: true,
        language: { url: "https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json" },
        pageLength: 5
    });
});
</script>
{% endblock %}
